### ContentEquatable.swift

| Protocol         | Property / Method                                      | Description                                                                                                                                                                                                                                                                                                 |
|------------------|--------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ContentEquatable | `isContentEqual(to source: Self) -> Bool`             | Compares whether the content of `self` is equal to the content of the given source value.                                                                                                                                                                                                                    |
| Optional         | `isContentEqual(to source: Wrapped?) -> Bool`         | Compares the content of an optional value to the content of another optional value. Returns `true` if both values are `nil`, `false` if one is `nil` and the other is not, and compares the content if both are non-`nil`.                                                                                 |
| Array            | `isContentEqual(to source: [Element]) -> Bool`         | Compares the content of an array to the content of another array by checking if they have the same number of elements and if each corresponding element is content equal.                                                                                                                              |
| Extension        | `isContentEqual(to source: Self) -> Bool`              | Default implementation for `ContentEquatable` protocol when `Self` conforms to `Equatable`. Uses the `==` operator of `Equatable` to compare the content.                                                                                                                                               |

The `ContentEquatable` protocol defines a method `isContentEqual(to:)` that must be implemented by conforming types to compare whether their contents are equal. The default implementation for types that conform to `Equatable` is provided in the extension. 

For `Optional` types where the wrapped value also conforms to `ContentEquatable`, the comparison logic checks if both values are `nil`, if one is `nil` and the other is not, or if both are non-`nil` and then compares their content.

For arrays where the elements also conform to `ContentEquatable`, the comparison logic checks if the arrays have the same number of elements and then iterates through each corresponding pair of elements to check if they are content equal.

Overall, the `ContentEquatable` protocol provides a way to compare the content equality of different types, allowing for more flexible and customizable comparisons based on the specific needs of the types involved.

### ArraySection.swift

| Property               | Type                                      | Description                                                                                      |
|------------------------|-------------------------------------------|--------------------------------------------------------------------------------------------------|
| model                  | Model                                     | The model of the section for differentiation with other sections.                              |
| elements               | [Element]                                 | An array of elements in the section.                                                            |
| differenceIdentifier   | Model.DifferenceIdentifier                | An identifier value of the model for difference calculation.                                     |

| Method                                | Description                                                                                      |
|---------------------------------------|--------------------------------------------------------------------------------------------------|
| init(model:elements:)                 | Initializes a section with the given model and elements.                                        |
| init(source:elements:)                | Initializes a new section reproducing the source section with replaced elements.                |
| isContentEqual(to:)                   | Compares the content of the section with another section based on the model.                    |

The `ArraySection` struct is a generic wrapper that represents a section in a collection view or table view. It contains a model object and an array of elements. The key properties and methods of the `ArraySection` struct are as follows:

1. `model`: This property holds the model object of the section, which is used for differentiation with other sections. The `differenceIdentifier` property returns the difference identifier of the model for difference calculation.

2. `elements`: This property is an array of elements in the section.

3. `init(model:elements:)`: This initializer creates a section with the specified model and elements.

4. `init(source:elements:)`: This initializer creates a new section by reproducing the source section with replaced elements.

5. `isContentEqual(to:)`: This method compares the content of the section with another section based on the model. It returns a Boolean value indicating whether the content of the two sections is equal.

6. Equatable conformance: The `ArraySection` struct conforms to the `Equatable` protocol when the `Model` and `Element` types also conform to `Equatable`. The equality comparison checks if the models and elements of two sections are equal.

7. CustomDebugStringConvertible conformance: The `debugDescription` property provides a custom debug description for the `ArraySection` struct, displaying the model and elements.

### Algorithm.swift

| Property/Method           | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|---------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| init(source:target:)      | Initializes a `StagedChangeset` instance with source and target collections, calculating the differences between them using an optimized algorithm based on Paul Heckel's diff algorithm. It handles cases where elements with the same identifier are duplicated and calculates moves, insertions, and deletions accordingly. It represents the middle of the changes and each changeset contains changes from the previous stage.                                                                                                                                                                                                                                                                                                                       |
| init(source:target:section:) | Similar to the above, but includes an additional `section` parameter to specify a section index or offset for the element.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| diff(source:target:useTargetIndexForUpdated:mapIndex:updatedElementsPointer:notDeletedElementsPointer:) | Shared algorithm to calculate differences between two linear collections. It tracks deleted, inserted, updated, and moved elements, along with source traces and target references. It handles cases where elements with the same identifier are duplicated, and optimizes performance by tracking indices of elements and using UnsafePointer for dictionary keys.                                                                                                                                                                                                                                                                                                                                                                                                              |
| DiffResult struct         | Contains a set of changes and metadata resulting from calculating differences in a linear collection. Includes deleted, inserted, updated, and moved indices, along with source traces and target references.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Trace struct              | Represents a set of information in the middle of difference calculation. Contains a reference to an index, delete offset, and a flag indicating if the element is tracked.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| IndicesReference class    | A mutable reference to indices of elements, used for tracking elements with the same identifier. Supports pushing new indices and retrieving the next index.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| TableKey struct           | Dictionary key using UnsafePointer for performance optimization. It combines the hash value of the pointee and the pointer for equality comparison and hashing.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| MutableCollection extension | Extends MutableCollection to support subscripting with an ElementPath, allowing easy access to elements in a nested collection using section and element indices.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |

### ContentIdentifiable.swift

| Property               | Type            | Description                                 |
|------------------------|-----------------|---------------------------------------------|
| DifferenceIdentifier   | associatedtype  | A type representing the identifier          |
| differenceIdentifier   | computed        | An identifier value for difference calculation|

이 protocol은 ContentIdentifiable이라는 값을 식별하는 데 사용되는 프로토콜을 정의한다. 

- associatedtype DifferenceIdentifier: Hashable: DifferenceIdentifier는 Hashable 프로토콜을 채택하는 타입을 나타내는 연관 타입이다. 
- var differenceIdentifier: DifferenceIdentifier: differenceIdentifier는 차이 계산을 위한 식별자 값을 나타내는 속성이다. 

extension으로 Self가 Hashable을 채택하는 경우 differenceIdentifier를 구현한 것을 확인할 수 있다. 이 경우에는 self 값을 식별자로 사용한다. 따라서 differenceIdentifier를 구현하면 해당 값을 구분하는 데 사용할 수 있다.

### AnyDifferentiable.swift

| Property            | Type                           | Description                                                                                                                                                                                           |
|---------------------|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| base                | Any                            | The value wrapped by this `AnyDifferentiable` instance.                                                                                                                                               |
| differenceIdentifier| AnyHashable                    | A type-erased identifier value for difference calculation.                                                                                                                                           |
| box                 | AnyDifferentiableBox           | The underlying box that stores the differentiable value.                                                                                                                                             |

| Method                      | Description                                                                                                                                                                                               |
|-----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| init(_:)                    | Creates a type-erased differentiable value that wraps the given instance.                                                                                                                                  |
| isContentEqual(to:)         | Indicate whether the content of `base` is equal to the content of the given source value.                                                                                                                |

The `AnyDifferentiable` struct provides a way to store mixed-type elements in a collection that requires `Differentiable` conformance. It hides the specific underlying types by using type erasure. The `base` property stores the wrapped value, while the `differenceIdentifier` property stores a type-erased identifier for difference calculation.

The `init(_:)` method initializes an `AnyDifferentiable` instance by wrapping a differentiable value. If the value is already an `AnyDifferentiable`, it simply assigns it to the new instance. Otherwise, it creates a new `DifferentiableBox` to store the value.

The `isContentEqual(to:)` method compares the content of the `base` property of the current instance with the content of the `base` property of the given source value. It forwards the comparison to the underlying differentiable value to check for equality.

Overall, the `AnyDifferentiable` struct allows for type-erased storage of differentiable values and enables comparisons between differentiable values with different underlying types.

### StagedChangeset.swift

| Property/Method           | Description                                                                                          |
|--------------------------|------------------------------------------------------------------------------------------------------|
| changesets               | ContiguousArray containing Changeset objects representing the staged set of changes in the collection |
| init(changesets:)        | Initializes a new StagedChangeset with a collection of Changeset objects                              |
| startIndex               | Returns the start index of the StagedChangeset                                                       |
| endIndex                 | Returns the end index of the StagedChangeset                                                         |
| index(after:)            | Returns the index after the specified index                                                          |
| subscript(position:)      | Allows access to the Changeset at a specific position in the StagedChangeset                          |
| replaceSubrange(_:with:) | Replaces a subrange of Changeset objects with new elements in the StagedChangeset                    |
| ==                       | Compares two StagedChangeset objects for equality                                                    |
| init(arrayLiteral:)      | Initializes a new StagedChangeset with a variadic list of Changeset objects                          |
| debugDescription         | Provides a debug description of the StagedChangeset                                                  |

The `StagedChangeset` struct represents an ordered collection of `Changeset` objects that serve as a staged set of changes in a sectioned collection. It is used to track and manage the changes between two collections in a way that facilitates batch-updates in UI elements like UITableView or UICollectionView without crashes.

The `StagedChangeset` struct allows for creating and manipulating collections of `Changeset` objects, providing methods to access, modify, and compare these staged sets of changes. By splitting the changes into minimal stages that can be applied without issues, the `StagedChangeset` ensures smooth updates in UI elements when transitioning between different data states.

### ElementPath.swift

| Property | Description |
|----------|-------------|
| element  | The element index (or offset) of the path |
| section  | The section index (or offset) of the path |

| Method                | Description                                                      |
|-----------------------|------------------------------------------------------------------|
| init(element:section:) | Initializes a new `ElementPath` with specified element and section indices |

The `ElementPath` struct represents a path to a specific element in a tree of nested collections. It contains properties for the element index and section index of the path. The `init(element:section:)` method allows for the creation of a new `ElementPath` with specified element and section indices.

The `ElementPath` struct also conforms to the `CustomDebugStringConvertible` protocol, providing a custom debug description that includes the element and section indices of the path. This can be useful for debugging purposes to easily view the contents of an `ElementPath` instance.

Overall, the `ElementPath` struct is a simple and straightforward data structure that can be used to represent paths in a nested collection hierarchy. It provides a convenient way to access and manipulate specific elements within a collection structure.

### DifferentiableSection.swift

| Property  | Description |
|-----------|-------------|
| elements  | The collection of elements in the section. |
|-----------|-------------|

| Method    | Description |
|-----------|-------------|
| init      | Creates a new section reproducing the given source section with replacing the elements. |

The `DifferentiableSection` protocol represents a section of a collection that can be identified and compared to determine whether it has been updated. It has a single associated type `Collection` which represents the elements in the section. The `elements` property returns the collection of elements in the section.

The protocol also defines an `init` method which is used to create a new section by reproducing a given source section with a new collection of elements. This method takes the source section and a collection of elements as parameters and initializes a new section with the provided elements.

Overall, the `DifferentiableSection` protocol is designed to encapsulate a section of a collection with the ability to compare and update its contents. It provides a standardized way to work with sections of collections in a differentiable manner.

### Changeset.swift

Changeset 구조체는 sectioned collection의 변경 사항을 나타내는 구조체입니다. 주요 property 및 method는 다음과 같습니다:

- Properties:
  - data: 변경 후의 collection을 나타냅니다.
  - sectionDeleted: 삭제된 섹션의 오프셋을 나타냅니다.
  - sectionInserted: 삽입된 섹션의 오프셋을 나타냅니다.
  - sectionUpdated: 업데이트된 섹션의 오프셋을 나타냅니다.
  - sectionMoved: 이동된 섹션의 소스와 타겟 오프셋을 나타냅니다.
  - elementDeleted: 삭제된 요소의 경로를 나타냅니다.
  - elementInserted: 삽입된 요소의 경로를 나타냅니다.
  - elementUpdated: 업데이트된 요소의 경로를 나타냅니다.
  - elementMoved: 이동된 요소의 소스와 타겟 경로를 나타냅니다.

- Methods:
  - init: Changeset을 초기화하는 메서드로, 각 변경 사항에 대한 정보를 받아 초기화합니다.
  - sectionChangeCount: 섹션 변경 사항의 개수를 반환하는 property입니다.
  - elementChangeCount: 요소 변경 사항의 개수를 반환하는 property입니다.
  - changeCount: 모든 변경 사항의 개수를 반환하는 property입니다.
  - hasSectionChanges: 섹션 변경 사항이 있는지를 나타내는 Boolean 값을 반환하는 property입니다.
  - hasElementChanges: 요소 변경 사항이 있는지를 나타내는 Boolean 값을 반환하는 property입니다.
  - hasChanges: 변경 사항이 있는지를 나타내는 Boolean 값을 반환하는 property입니다. 

Changeset 구조체는 Equatable 프로토콜을 채택하여 동등성을 비교할 수 있습니다. 또한 CustomDebugStringConvertible 프로토콜을 채택하여 디버그 설명을 제공합니다. 내부적으로 HashablePair 구조체를 사용하여 요소의 동등성을 비교합니다.

이 구조체를 사용하여 섹션 및 요소의 변경 사항을 추적하고 처리할 수 있습니다. 섹션 및 요소의 추가, 삭제, 업데이트, 이동 등의 변경 사항을 Changeset 구조체에 저장하고 필요한 경우 해당 변경 사항을 적용할 수 있습니다. 이를 통해 섹션화된 컬렉션의 변경 사항을 효과적으로 관리하고 적용할 수 있습니다.

### Differentiable.swift

| Property/Method         | Description                                                                                       |
|-------------------------|---------------------------------------------------------------------------------------------------|
| `id`                    | A property that uniquely identifies the value.                                                     |
| `equatableContent`      | A method that checks whether the contents of two values are equal.                                 |
| `difference(from:)`     | A method that computes the difference between two values.                                           |
| `merge(with:)`          | A method that merges two values into a single value.                                                |
| `moved(from:to:)`       | A method that indicates whether a value has moved from one index to another in a collection.       |

The `Differentiable` protocol combines the `ContentIdentifiable` and `ContentEquatable` protocols, which are used for identifying and comparing values for equality, respectively. By conforming to the `Differentiable` protocol, a type can ensure that it can be uniquely identified and compared for equality based on its content.

The `id` property is used to uniquely identify a value, which is essential for tracking changes and differences between values. The `equatableContent` method checks whether the contents of two values are equal, allowing for equality comparison based on content.

The `difference(from:)` method computes the difference between two values, which is useful for determining how one value can be transformed into another. The `merge(with:)` method combines two values into a single value, which is beneficial for merging changes from different sources.

The `moved(from:to:)` method indicates whether a value has moved from one index to another in a collection, which can be crucial for maintaining consistency and tracking changes in ordered collections. Overall, the `Differentiable` protocol provides essential functionality for identifying, comparing, and transforming values based on their content.

### Extensions/AppKitExtension.swift

| Protocol/Class   | Property/Method                                      | Description                                                                                                                                                                                                                         |
|------------------|------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| NSTableView      | reload(using stagedChangeset:with:interrupt:setData) | Applies multiple animated updates in stages using `StagedChangeset`. It updates the data-source of NSTableView synchronously before performing the updates. It also provides an option to interrupt the updates and stop the animation. |
| NSTableView      | reload(using stagedChangeset:deleteRowsAnimation:insertRowsAnimation:reloadRowsAnimation:interrupt:setData) | Applies multiple animated updates in stages using `StagedChangeset` with more specific animation options for row deletion, insertion, and reload. It also provides an option to interrupt the updates and stop the animation. |
| NSTableView      | reload(using stagedChangeset:deleteRowsAnimation:insertRowsAnimation:reloadRowsAnimation:interrupt:setData) | Updates the table view with the staged changeset, handling row deletion, insertion, reload, and movement animations. It also provides an option to interrupt the updates and stop the animation.                                    |
| NSCollectionView  | reload(using stagedChangeset:interrupt:setData)     | Applies multiple animated updates in stages using `StagedChangeset`. It updates the data-source of NSCollectionView synchronously before performing the updates. It also provides an option to interrupt the updates and stop the animation. | 

The `reload` methods in both `NSTableView` and `NSCollectionView` extensions apply multiple animated updates in stages using `StagedChangeset`. They handle various types of changes such as row deletion, insertion, reload, and movement animations. The methods ensure that the data-source is updated synchronously before performing the updates.

The methods also provide an option to interrupt the updates and stop the animation if needed. This can be useful in cases where certain combinations of changes may cause crashes if applied simultaneously. By using staged changesets and interrupt closures, the methods allow for more controlled and safe updates to the table view or collection view.

### Extensions/UIKitExtension.swift

| Protocol      | Property/Method                                             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|---------------|-------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

